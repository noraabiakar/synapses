This repository contains 3 versions of the same mechanism (Ampa)[https://senselab.med.yale.edu/ModelDB/ShowModel?model=128446&file=%2fShortTermPlasticityMFGRC_Nieus2006%2fAmpa.mod#tabs-2] obtained from modeldb. 
1. AMPA.mod
   This file modifies the original mechanism in the following (major) ways: 
   - arrays `tspike` and `PRE` are commented out, along with the definition and usage of the `NTdiffusion` function. This is because arbor's modcc doesn't support arrays and for loops.  
   - `on`, `t0`, `x`, `y`, `u` are ASSIGNED instead of arguments to the `NET_RECEIVE` function. This means that these variables are not shared among connections to the same synapse. This is needed because arbor doesn't support connection variables. 
   - `delay` is added as a new state variable. It is needed to replace the `net_send` functionality. It decays linearly and acts as a timeri, delaying the effect of a spike, similar to `net_send` in the original code.  
   
2. cat/ 
   This directory contains the CPU and GPU versions of `AMPA.mod` written against Arbor's mechanism ABI. 
   The files where generated by running arbor's modcc `modcc -t gpui -t cpu -N arb::Ampa_catalogue -o Ampa AMPA.mod`, then modified in the following (major) ways: 
   - The arrays `tspike` and `PRE` as well as the definition and usage of the `NTdiffusion` function were added again. 
   - The code was simplified for readability. 
   This directory can be used to generate a mechanism catalogue (which can then be loaded in arbor) using `arbor-build-catalogue Ampa cat/ --raw Ampa -g cuda -C`. 
   Writing mechanisms this way is not recommended as it requires C++ knowledge as well as sufficient knowledge of the mechanism ABI. However, it can be used to verify the performance of the final version of the mechanism `AMPA_approx.mod`

3. AMPA_approx.mod 
   This file modifies `AMPA.mod` in the following (major) ways:
   - A kinetic scheme `gstate` is added to approximate the effect of the `NTdiffusion` function. It works on 3 state variables `g_active`, `g_emission`, `g_surround`
   ```
    g_emission <-> g_active   (alpha, beta)
    g_active   <-> g_surround (gamma, delta)
    g_surround <-> (epsilon, 0)
   ```
   The first equation represents the diffusion of glutamate between the emission area and the active area.
   The second equation represents the diffusion of glutamate between the active area and the surrounds.
   The third equation represnts the dissipation of gutamate to the surroundings. 
 
   Initial values for `g_active`, `g_emission`, `g_surround` are yet to be determined. 
   Values for `alpha`, `beta`, `gamma`, `delta`, `epsilon` are yet to be determined. 
